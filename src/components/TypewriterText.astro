---
interface Props {
  words: string[];
  typingSpeed?: number;
  deletingSpeed?: number;
  pauseTime?: number;
}

const { 
  words, 
  typingSpeed = 80,
  deletingSpeed = 40,
  pauseTime = 3000
} = Astro.props;
---

<span class="typewriter-text"></span>
<span class="typewriter-cursor">|</span>

<script define:vars={{ words, typingSpeed, deletingSpeed, pauseTime }}>
  const textElement = document.querySelector('.typewriter-text');
  const cursorElement = document.querySelector('.typewriter-cursor');
  let wordIndex = 0;
  let charIndex = 0;
  let isDeleting = false;
  let isWaiting = false;

  function type() {
    const currentWord = words[wordIndex];
    
    if (isDeleting) {
      charIndex--;
      textElement.textContent = currentWord.substring(0, charIndex);
    } else {
      charIndex++;
      textElement.textContent = currentWord.substring(0, charIndex);
    }

    // Cursor blinking
    cursorElement.style.opacity = '1';
    setTimeout(() => {
      cursorElement.style.opacity = '0';
    }, 400);

    let typeSpeed = isDeleting ? deletingSpeed : typingSpeed;

    if (!isDeleting && charIndex === currentWord.length) {
      // Word is complete
      isWaiting = true;
      typeSpeed = pauseTime;
      setTimeout(() => {
        isDeleting = true;
        isWaiting = false;
      }, pauseTime);
    } else if (isDeleting && charIndex === 0) {
      isDeleting = false;
      wordIndex = (wordIndex + 1) % words.length;
    }

    if (!isWaiting) {
      setTimeout(type, typeSpeed);
    } else {
      setTimeout(type, pauseTime);
    }
  }

  // Start typing
  setTimeout(type, 1000);
</script>

<style>
  .typewriter-text {
    display: inline;
    background: linear-gradient(90deg, #fff, #99AAB5);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-size: 200% auto;
    animation: shine 4s linear infinite;
  }

  .typewriter-cursor {
    display: inline-block;
    width: 2px;
    margin-left: 2px;
    background: linear-gradient(90deg, #fff, #99AAB5);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: blink 0.8s infinite;
  }

  @keyframes shine {
    to {
      background-position: 200% center;
    }
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }
</style>
